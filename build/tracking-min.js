/**
 * tracking - A modern approach for Computer Vision on the web.
 * @author Eduardo Lundgren <edu@rdo.io>
 * @version v1.1.1
 * @link http://trackingjs.com
 * @license BSD
 */
!function(t){t.tracking=t.tracking||{},tracking.inherits=function(t,r){function e(){}e.prototype=r.prototype,t.superClass_=r.prototype,t.prototype=new e,t.prototype.constructor=t,t.base=function(t,e){var n=Array.prototype.slice.call(arguments,2);return r.prototype[e].apply(t,n)}},tracking.initUserMedia_=function(r,e){t.navigator.getUserMedia({video:!0,audio:e.audio},function(e){try{r.src=t.URL.createObjectURL(e)}catch(n){r.src=e}},function(){throw Error("Cannot capture user camera.")})},tracking.isNode=function(t){return t.nodeType||this.isWindow(t)},tracking.isWindow=function(t){return!!(t&&t.alert&&t.document)},tracking.one=function(t,r){return this.isNode(t)?t:(r||document).querySelector(t)},tracking.track=function(t,r,e){if(t=tracking.one(t),!t)throw new Error("Element not found, try a different element or selector.");if(!r)throw new Error("Tracker not specified, try `tracking.track(element, new tracking.FaceTracker())`.");switch(t.nodeName.toLowerCase()){case"canvas":return this.trackCanvas_(t,r,e);case"img":return this.trackImg_(t,r,e);case"video":return e&&e.camera&&this.initUserMedia_(t,e),this.trackVideo_(t,r,e);default:throw new Error("Element not supported, try in a canvas, img, or video.")}},tracking.trackCanvas_=function(t,r){var e=this,n=new tracking.TrackerTask(r);return n.on("run",function(){e.trackCanvasInternal_(t,r)}),n.run()},tracking.trackCanvasInternal_=function(t,r){var e=t.width,n=t.height,i=t.getContext("2d"),a=i.getImageData(0,0,e,n);r.track(a.data,e,n)},tracking.trackImg_=function(t,r){var e=t.width,n=t.height,i=document.createElement("canvas");i.width=e,i.height=n;var a=new tracking.TrackerTask(r);return a.on("run",function(){tracking.Canvas.loadImage(i,t.src,0,0,e,n,function(){tracking.trackCanvasInternal_(i,r)})}),a.run()},tracking.trackVideo_=function(r,e){var n,i,a=document.createElement("canvas"),o=a.getContext("2d"),s=function(){n=r.offsetWidth,i=r.offsetHeight,a.width=n,a.height=i};s(),r.addEventListener("resize",s);var c,u=function(){c=t.setTimeout(function(){if(r.readyState===r.HAVE_ENOUGH_DATA){try{o.drawImage(r,0,0,n,i)}catch(t){}tracking.trackCanvasInternal_(a,e)}u()},250)},f=new tracking.TrackerTask(e);return f.on("stop",function(){t.clearTimeout(c)}),f.on("run",function(){u()}),f.run()},t.URL||(t.URL=t.URL||t.webkitURL||t.msURL||t.oURL),navigator.getUserMedia||(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia)}(this),function(){tracking.EventEmitter=function(){},tracking.EventEmitter.prototype.events_=null,tracking.EventEmitter.prototype.addListener=function(t,r){if("function"!=typeof r)throw new TypeError("Listener must be a function");return this.events_||(this.events_={}),this.emit("newListener",t,r),this.events_[t]||(this.events_[t]=[]),this.events_[t].push(r),this},tracking.EventEmitter.prototype.listeners=function(t){return this.events_&&this.events_[t]},tracking.EventEmitter.prototype.emit=function(t){var r=this.listeners(t);if(r){for(var e=Array.prototype.slice.call(arguments,1),n=0;n<r.length;n++)r[n]&&r[n].apply(this,e);return!0}return!1},tracking.EventEmitter.prototype.on=tracking.EventEmitter.prototype.addListener,tracking.EventEmitter.prototype.once=function(t,r){var e=this;e.on(t,function n(){e.removeListener(t,n),r.apply(this,arguments)})},tracking.EventEmitter.prototype.removeAllListeners=function(t){return this.events_?(t?delete this.events_[t]:delete this.events_,this):this},tracking.EventEmitter.prototype.removeListener=function(t,r){if("function"!=typeof r)throw new TypeError("Listener must be a function");if(!this.events_)return this;var e=this.listeners(t);if(Array.isArray(e)){var n=e.indexOf(r);if(0>n)return this;e.splice(n,1)}return this},tracking.EventEmitter.prototype.setMaxListeners=function(){throw new Error("Not implemented")}}(),function(){tracking.Canvas={},tracking.Canvas.loadImage=function(t,r,e,n,i,a,o){var s=this,c=new window.Image;c.crossOrigin="*",c.onload=function(){var r=t.getContext("2d");t.width=i,t.height=a,r.drawImage(c,e,n,i,a),o&&o.call(s),c=null},c.src=r}}(),function(){tracking.DisjointSet=function(t){if(void 0===t)throw new Error("DisjointSet length not specified.");this.length=t,this.parent=new Uint32Array(t);for(var r=0;t>r;r++)this.parent[r]=r},tracking.DisjointSet.prototype.length=null,tracking.DisjointSet.prototype.parent=null,tracking.DisjointSet.prototype.find=function(t){return this.parent[t]===t?t:this.parent[t]=this.find(this.parent[t])},tracking.DisjointSet.prototype.union=function(t,r){var e=this.find(t),n=this.find(r);this.parent[e]=n}}(),function(){tracking.Image={},tracking.Image.blur=function(t,r,e,n){if(n=Math.abs(n),1>=n)throw new Error("Diameter should be greater than 1.");for(var i=n/2,a=Math.ceil(n)+(1-Math.ceil(n)%2),o=new Float32Array(a),s=(i+.5)/3,c=s*s,u=1/Math.sqrt(2*Math.PI*c),f=-1/(2*s*s),l=0,h=Math.floor(a/2),g=0;a>g;g++){var p=g-h,k=u*Math.exp(p*p*f);o[g]=k,l+=k}for(var d=0;d<o.length;d++)o[d]/=l;return this.separableConvolve(t,r,e,o,o,!1)},tracking.Image.computeIntegralImage=function(t,r,e,n,i,a,o){if(arguments.length<4)throw new Error("You should specify at least one output array in the order: sum, square, tilted, sobel.");var s;o&&(s=tracking.Image.sobel(t,r,e));for(var c=0;e>c;c++)for(var u=0;r>u;u++){var f=c*r*4+4*u,l=~~(.299*t[f]+.587*t[f+1]+.114*t[f+2]);if(n&&this.computePixelValueSAT_(n,r,c,u,l),i&&this.computePixelValueSAT_(i,r,c,u,l*l),a){var h=f-4*r,g=~~(.299*t[h]+.587*t[h+1]+.114*t[h+2]);this.computePixelValueRSAT_(a,r,c,u,l,g||0)}o&&this.computePixelValueSAT_(o,r,c,u,s[f])}},tracking.Image.computePixelValueRSAT_=function(t,r,e,n,i,a){var o=e*r+n;t[o]=(t[o-r-1]||0)+(t[o-r+1]||0)-(t[o-r-r]||0)+i+a},tracking.Image.computePixelValueSAT_=function(t,r,e,n,i){var a=e*r+n;t[a]=(t[a-r]||0)+(t[a-1]||0)+i-(t[a-r-1]||0)},tracking.Image.grayscale=function(t,r,e,n){for(var i=new Uint8ClampedArray(n?t.length:t.length>>2),a=0,o=0,s=0;e>s;s++)for(var c=0;r>c;c++){var u=.299*t[o]+.587*t[o+1]+.114*t[o+2];i[a++]=u,n&&(i[a++]=u,i[a++]=u,i[a++]=t[o+3]),o+=4}return i},tracking.Image.horizontalConvolve=function(t,r,e,n,i){for(var a=n.length,o=Math.floor(a/2),s=new Float32Array(r*e*4),c=i?1:0,u=0;e>u;u++)for(var f=0;r>f;f++){for(var l=u,h=f,g=4*(u*r+f),p=0,k=0,d=0,v=0,m=0;a>m;m++){var y=l,w=Math.min(r-1,Math.max(0,h+m-o)),_=4*(y*r+w),T=n[m];p+=t[_]*T,k+=t[_+1]*T,d+=t[_+2]*T,v+=t[_+3]*T}s[g]=p,s[g+1]=k,s[g+2]=d,s[g+3]=v+c*(255-v)}return s},tracking.Image.verticalConvolve=function(t,r,e,n,i){for(var a=n.length,o=Math.floor(a/2),s=new Float32Array(r*e*4),c=i?1:0,u=0;e>u;u++)for(var f=0;r>f;f++){for(var l=u,h=f,g=4*(u*r+f),p=0,k=0,d=0,v=0,m=0;a>m;m++){var y=Math.min(e-1,Math.max(0,l+m-o)),w=h,_=4*(y*r+w),T=n[m];p+=t[_]*T,k+=t[_+1]*T,d+=t[_+2]*T,v+=t[_+3]*T}s[g]=p,s[g+1]=k,s[g+2]=d,s[g+3]=v+c*(255-v)}return s},tracking.Image.separableConvolve=function(t,r,e,n,i,a){var o=this.verticalConvolve(t,r,e,i,a);return this.horizontalConvolve(o,r,e,n,a)},tracking.Image.sobel=function(t,r,e){t=this.grayscale(t,r,e,!0);for(var n=new Float32Array(r*e*4),i=new Float32Array([-1,0,1]),a=new Float32Array([1,2,1]),o=this.separableConvolve(t,r,e,i,a),s=this.separableConvolve(t,r,e,a,i),c=0;c<n.length;c+=4){var u=o[c],f=s[c],l=Math.sqrt(f*f+u*u);n[c]=l,n[c+1]=l,n[c+2]=l,n[c+3]=255}return n}}(),function(){tracking.ViolaJones={},tracking.ViolaJones.REGIONS_OVERLAP=.5,tracking.ViolaJones.classifiers={},tracking.ViolaJones.detect=function(t,r,e,n,i,a,o,s){var c,u=0,f=[],l=new Int32Array(r*e),h=new Int32Array(r*e),g=new Int32Array(r*e);o>0&&(c=new Int32Array(r*e)),tracking.Image.computeIntegralImage(t,r,e,l,h,g,c);for(var p=s[0],k=s[1],d=n*i,v=d*p|0,m=d*k|0;r>v&&e>m;){for(var y=d*a+.5|0,w=0;e-m>w;w+=y)for(var _=0;r-v>_;_+=y)o>0&&this.isTriviallyExcluded(o,c,w,_,r,v,m)||this.evalStages_(s,l,h,g,w,_,r,v,m,d)&&(f[u++]={width:v,height:m,x:_,y:w});d*=i,v=d*p|0,m=d*k|0}return this.mergeRectangles_(f)},tracking.ViolaJones.isTriviallyExcluded=function(t,r,e,n,i,a,o){var s=e*i+n,c=s+a,u=s+o*i,f=u+a,l=(r[s]-r[c]-r[u]+r[f])/(a*o*255);return t>l?!0:!1},tracking.ViolaJones.evalStages_=function(t,r,e,n,i,a,o,s,c,u){var f=1/(s*c),l=i*o+a,h=l+s,g=l+c*o,p=g+s,k=(r[l]-r[h]-r[g]+r[p])*f,d=(e[l]-e[h]-e[g]+e[p])*f-k*k,v=1;d>0&&(v=Math.sqrt(d));for(var m=t.length,y=2;m>y;){for(var w=0,_=t[y++],T=t[y++];T--;){for(var b=0,C=t[y++],S=t[y++],E=0;S>E;E++){var M,O,x,R,I=a+t[y++]*u+.5|0,A=i+t[y++]*u+.5|0,j=t[y++]*u+.5|0,B=t[y++]*u+.5|0,L=t[y++];C?(M=I-B+j+(A+j+B-1)*o,O=I+(A-1)*o,x=I-B+(A+B-1)*o,R=I+j+(A+j-1)*o,b+=(n[M]+n[O]-n[x]-n[R])*L):(M=A*o+I,O=M+j,x=M+B*o,R=x+j,b+=(r[M]-r[O]-r[x]+r[R])*L)}var D=t[y++],U=t[y++],W=t[y++];w+=D*v>b*f?U:W}if(_>w)return!1}return!0},tracking.ViolaJones.mergeRectangles_=function(t){for(var r=new tracking.DisjointSet(t.length),e=0;e<t.length;e++)for(var n=t[e],i=0;i<t.length;i++){var a=t[i];if(tracking.Math.intersectRect(n.x,n.y,n.x+n.width,n.y+n.height,a.x,a.y,a.x+a.width,a.y+a.height)){var o=Math.max(n.x,a.x),s=Math.max(n.y,a.y),c=Math.min(n.x+n.width,a.x+a.width),u=Math.min(n.y+n.height,a.y+a.height),f=(o-c)*(s-u),l=n.width*n.height,h=a.width*a.height;f/(l*(l/h))>=this.REGIONS_OVERLAP&&f/(h*(l/h))>=this.REGIONS_OVERLAP&&r.union(e,i)}}for(var g={},p=0;p<r.length;p++){var k=r.find(p);g[k]?(g[k].total++,g[k].width+=t[p].width,g[k].height+=t[p].height,g[k].x+=t[p].x,g[k].y+=t[p].y):g[k]={total:1,width:t[p].width,height:t[p].height,x:t[p].x,y:t[p].y}}var d=[];return Object.keys(g).forEach(function(t){var r=g[t];d.push({total:r.total,width:r.width/r.total+.5|0,height:r.height/r.total+.5|0,x:r.x/r.total+.5|0,y:r.y/r.total+.5|0})}),d}}(),function(){tracking.Brief={},tracking.Brief.N=512,tracking.Brief.randomImageOffsets_={},tracking.Brief.randomWindowOffsets_=null,tracking.Brief.getDescriptors=function(t,r,e){for(var n=new Int32Array((e.length>>1)*(this.N>>5)),i=0,a=this.getRandomOffsets_(r),o=0,s=0;s<e.length;s+=2)for(var c=r*e[s+1]+e[s],u=0,f=0,l=this.N;l>f;f++)t[a[u++]+c]<t[a[u++]+c]&&(i|=1<<(31&f)),f+1&31||(n[o++]=i,i=0);return n},tracking.Brief.match=function(t,r,e,n){for(var i=t.length>>1,a=e.length>>1,o=new Array(i),s=0;i>s;s++){for(var c=1/0,u=0,f=0;a>f;f++){for(var l=0,h=0,g=this.N>>5;g>h;h++)l+=tracking.Math.hammingWeight(r[s*g+h]^n[f*g+h]);c>l&&(c=l,u=f)}o[s]={index1:s,index2:u,keypoint1:[t[2*s],t[2*s+1]],keypoint2:[e[2*u],e[2*u+1]],confidence:1-c/this.N}}return o},tracking.Brief.reciprocalMatch=function(t,r,e,n){var i=[];if(0===t.length||0===e.length)return i;for(var a=tracking.Brief.match(t,r,e,n),o=tracking.Brief.match(e,n,t,r),s=0;s<a.length;s++)o[a[s].index2].index2===s&&i.push(a[s]);return i},tracking.Brief.getRandomOffsets_=function(t){if(!this.randomWindowOffsets_){for(var r=0,e=new Int32Array(4*this.N),n=0;n<this.N;n++)e[r++]=Math.round(tracking.Math.uniformRandom(-15,16)),e[r++]=Math.round(tracking.Math.uniformRandom(-15,16)),e[r++]=Math.round(tracking.Math.uniformRandom(-15,16)),e[r++]=Math.round(tracking.Math.uniformRandom(-15,16));this.randomWindowOffsets_=e}if(!this.randomImageOffsets_[t]){for(var i=0,a=new Int32Array(2*this.N),o=0;o<this.N;o++)a[i++]=this.randomWindowOffsets_[4*o]*t+this.randomWindowOffsets_[4*o+1],a[i++]=this.randomWindowOffsets_[4*o+2]*t+this.randomWindowOffsets_[4*o+3];this.randomImageOffsets_[t]=a}return this.randomImageOffsets_[t]}}(),function(){tracking.Fast={},tracking.Fast.THRESHOLD=40,tracking.Fast.circles_={},tracking.Fast.findCorners=function(t,r,e,n){var i=this.getCircleOffsets_(r),a=new Int32Array(16),o=[];void 0===n&&(n=this.THRESHOLD);for(var s=3;e-3>s;s++)for(var c=3;r-3>c;c++){for(var u=s*r+c,f=t[u],l=0;16>l;l++)a[l]=t[u+i[l]];this.isCorner(f,a,n)&&(o.push(c,s),c+=3)}return o},tracking.Fast.isBrighter=function(t,r,e){return t-r>e},tracking.Fast.isCorner=function(t,r,e){if(this.isTriviallyExcluded(r,t,e))return!1;for(var n=0;16>n;n++){for(var i=!0,a=!0,o=0;9>o;o++){var s=r[n+o&15];if(!this.isBrighter(t,s,e)&&(a=!1,i===!1))break;if(!this.isDarker(t,s,e)&&(i=!1,a===!1))break}if(a||i)return!0}return!1},tracking.Fast.isDarker=function(t,r,e){return r-t>e},tracking.Fast.isTriviallyExcluded=function(t,r,e){var n=0,i=t[8],a=t[12],o=t[4],s=t[0];return this.isBrighter(s,r,e)&&n++,this.isBrighter(o,r,e)&&n++,this.isBrighter(i,r,e)&&n++,this.isBrighter(a,r,e)&&n++,3>n&&(n=0,this.isDarker(s,r,e)&&n++,this.isDarker(o,r,e)&&n++,this.isDarker(i,r,e)&&n++,this.isDarker(a,r,e)&&n++,3>n)?!0:!1},tracking.Fast.getCircleOffsets_=function(t){if(this.circles_[t])return this.circles_[t];var r=new Int32Array(16);return r[0]=-t-t-t,r[1]=r[0]+1,r[2]=r[1]+t+1,r[3]=r[2]+t+1,r[4]=r[3]+t,r[5]=r[4]+t,r[6]=r[5]+t-1,r[7]=r[6]+t-1,r[8]=r[7]-1,r[9]=r[8]-1,r[10]=r[9]-t-1,r[11]=r[10]-t-1,r[12]=r[11]-t,r[13]=r[12]-t,r[14]=r[13]-t+1,r[15]=r[14]-t+1,this.circles_[t]=r,r}}(),function(){tracking.Math={},tracking.Math.distance=function(t,r,e,n){var i=e-t,a=n-r;return Math.sqrt(i*i+a*a)},tracking.Math.hammingWeight=function(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24},tracking.Math.uniformRandom=function(t,r){return t+Math.random()*(r-t)},tracking.Math.intersectRect=function(t,r,e,n,i,a,o,s){return!(i>e||t>o||a>n||r>s)}}(),function(){tracking.Matrix={},tracking.Matrix.forEach=function(t,r,e,n,i){i=i||1;for(var a=0;e>a;a+=i)for(var o=0;r>o;o+=i){var s=a*r*4+4*o;n.call(this,t[s],t[s+1],t[s+2],t[s+3],s,a,o)}}}(),function(){tracking.EPnP={},tracking.EPnP.solve=function(){}}(),function(){tracking.Tracker=function(){tracking.Tracker.base(this,"constructor")},tracking.inherits(tracking.Tracker,tracking.EventEmitter),tracking.Tracker.prototype.track=function(){}}(),function(){tracking.TrackerTask=function(t){if(tracking.TrackerTask.base(this,"constructor"),!t)throw new Error("Tracker instance not specified.");this.setTracker(t)},tracking.inherits(tracking.TrackerTask,tracking.EventEmitter),tracking.TrackerTask.prototype.tracker_=null,tracking.TrackerTask.prototype.running_=!1,tracking.TrackerTask.prototype.getTracker=function(){return this.tracker_},tracking.TrackerTask.prototype.inRunning=function(){return this.running_},tracking.TrackerTask.prototype.setRunning=function(t){this.running_=t},tracking.TrackerTask.prototype.setTracker=function(t){this.tracker_=t},tracking.TrackerTask.prototype.run=function(){var t=this;if(!this.inRunning())return this.setRunning(!0),this.reemitTrackEvent_=function(r){t.emit("track",r)},this.tracker_.on("track",this.reemitTrackEvent_),this.emit("run"),this},tracking.TrackerTask.prototype.stop=function(){return this.inRunning()?(this.setRunning(!1),this.emit("stop"),this.tracker_.removeListener("track",this.reemitTrackEvent_),this):void 0}}(),function(){tracking.ColorTracker=function(t){tracking.ColorTracker.base(this,"constructor"),"string"==typeof t&&(t=[t]),t&&(t.forEach(function(t){if(!tracking.ColorTracker.getColor(t))throw new Error('Color not valid, try `new tracking.ColorTracker("magenta")`.')}),this.setColors(t))},tracking.inherits(tracking.ColorTracker,tracking.Tracker),tracking.ColorTracker.knownColors_={},tracking.ColorTracker.neighbours_={},tracking.ColorTracker.registerColor=function(t,r){tracking.ColorTracker.knownColors_[t]=r},tracking.ColorTracker.getColor=function(t){return tracking.ColorTracker.knownColors_[t]},tracking.ColorTracker.prototype.colors=["magenta"],tracking.ColorTracker.prototype.minDimension=20,tracking.ColorTracker.prototype.maxDimension=1/0,tracking.ColorTracker.prototype.minGroupSize=30,tracking.ColorTracker.prototype.calculateDimensions_=function(t,r){for(var e=-1,n=-1,i=1/0,a=1/0,o=0;r>o;o+=2){var s=t[o],c=t[o+1];i>s&&(i=s),s>e&&(e=s),a>c&&(a=c),c>n&&(n=c)}return{width:e-i,height:n-a,x:i,y:a}},tracking.ColorTracker.prototype.getColors=function(){return this.colors},tracking.ColorTracker.prototype.getMinDimension=function(){return this.minDimension},tracking.ColorTracker.prototype.getMaxDimension=function(){return this.maxDimension},tracking.ColorTracker.prototype.getMinGroupSize=function(){return this.minGroupSize},tracking.ColorTracker.prototype.getNeighboursForWidth_=function(t){if(tracking.ColorTracker.neighbours_[t])return tracking.ColorTracker.neighbours_[t];var r=new Int32Array(8);return r[0]=4*-t,r[1]=4*-t+4,r[2]=4,r[3]=4*t+4,r[4]=4*t,r[5]=4*t-4,r[6]=-4,r[7]=4*-t-4,tracking.ColorTracker.neighbours_[t]=r,r},tracking.ColorTracker.prototype.mergeRectangles_=function(t){for(var r,e=[],n=this.getMinDimension(),i=this.getMaxDimension(),a=0;a<t.length;a++){var o=t[a];r=!0;for(var s=a+1;s<t.length;s++){var c=t[s];if(tracking.Math.intersectRect(o.x,o.y,o.x+o.width,o.y+o.height,c.x,c.y,c.x+c.width,c.y+c.height)){r=!1;var u=Math.min(o.x,c.x),f=Math.min(o.y,c.y),l=Math.max(o.x+o.width,c.x+c.width),h=Math.max(o.y+o.height,c.y+c.height);c.height=h-f,c.width=l-u,c.x=u,c.y=f;break}}r&&o.width>=n&&o.height>=n&&o.width<=i&&o.height<=i&&e.push(o)}return e},tracking.ColorTracker.prototype.setColors=function(t){this.colors=t},tracking.ColorTracker.prototype.setMinDimension=function(t){this.minDimension=t},tracking.ColorTracker.prototype.setMaxDimension=function(t){this.maxDimension=t},tracking.ColorTracker.prototype.setMinGroupSize=function(t){this.minGroupSize=t},tracking.ColorTracker.prototype.track=function(t,r,e){var n=this,i=this.getColors();if(!i)throw new Error('Colors not specified, try `new tracking.ColorTracker("magenta")`.');var a=[];i.forEach(function(i){a=a.concat(n.trackColor_(t,r,e,i))}),this.emit("track",{data:a})},tracking.ColorTracker.prototype.trackColor_=function(e,n,i,a){var o,s,c,u,f,l=tracking.ColorTracker.knownColors_[a],h=new Int32Array(e.length>>2),g=new Int8Array(e.length),p=this.getMinGroupSize(),k=this.getNeighboursForWidth_(n),d=new Int32Array(e.length),v=[],m=-4;if(!l)return v;for(var y=0;i>y;y++)for(var w=0;n>w;w++)if(m+=4,!g[m]){for(o=0,f=-1,d[++f]=m,d[++f]=y,d[++f]=w,g[m]=1;f>=0;)if(c=d[f--],s=d[f--],u=d[f--],l(e[u],e[u+1],e[u+2],e[u+3],u,s,c)){h[o++]=c,h[o++]=s;for(var _=0;_<k.length;_++){var T=u+k[_],b=s+t[_],C=c+r[_];!g[T]&&b>=0&&i>b&&C>=0&&n>C&&(d[++f]=T,d[++f]=b,d[++f]=C,g[T]=1)}}if(o>=p){var S=this.calculateDimensions_(h,o);S&&(S.color=a,v.push(S))}}return this.mergeRectangles_(v)},tracking.ColorTracker.registerColor("cyan",function(t,r,e){var n=50,i=70,a=t-0,o=r-255,s=e-255;return r-t>=n&&e-t>=i?!0:6400>a*a+o*o+s*s}),tracking.ColorTracker.registerColor("magenta",function(t,r,e){var n=50,i=t-255,a=r-0,o=e-255;return t-r>=n&&e-r>=n?!0:19600>i*i+a*a+o*o}),tracking.ColorTracker.registerColor("yellow",function(t,r,e){var n=50,i=t-255,a=r-255,o=e-0;return t-e>=n&&r-e>=n?!0:1e4>i*i+a*a+o*o});var t=new Int32Array([-1,-1,0,1,1,1,0,-1]),r=new Int32Array([0,1,1,1,0,-1,-1,-1])}(),function(){tracking.ObjectTracker=function(t){tracking.ObjectTracker.base(this,"constructor"),t&&(Array.isArray(t)||(t=[t]),Array.isArray(t)&&t.forEach(function(r,e){if("string"==typeof r&&(t[e]=tracking.ViolaJones.classifiers[r]),!t[e])throw new Error('Object classifier not valid, try `new tracking.ObjectTracker("face")`.')})),this.setClassifiers(t)},tracking.inherits(tracking.ObjectTracker,tracking.Tracker),tracking.ObjectTracker.prototype.edgesDensity=.2,tracking.ObjectTracker.prototype.initialScale=1,tracking.ObjectTracker.prototype.scaleFactor=1.25,tracking.ObjectTracker.prototype.stepSize=1.5,tracking.ObjectTracker.prototype.getClassifiers=function(){return this.classifiers},tracking.ObjectTracker.prototype.getEdgesDensity=function(){return this.edgesDensity},tracking.ObjectTracker.prototype.getInitialScale=function(){return this.initialScale},tracking.ObjectTracker.prototype.getScaleFactor=function(){return this.scaleFactor},tracking.ObjectTracker.prototype.getStepSize=function(){return this.stepSize},tracking.ObjectTracker.prototype.track=function(t,r,e){var n=this,i=[this.getOperation()],a=i.map(function(i){return i.call(t,r,e,n.getInitialScale(),n.getScaleFactor(),n.getStepSize(),n.getEdgesDensity())});a[0].then(function(t){n.emit("track",{data:t})})},tracking.ObjectTracker.prototype.getOperation=function(){if(this.operation)return this.operation;var t=this.getClassifiers();if(!t)throw new Error('Object classifier not specified, try `new tracking.ObjectTracker("face")`.');return this.operation=operative({data:{classifier:t[0]},call:function(t,r,e,n,i,a,o){var s=this.deferred(),c=this.data.classifier,u=tracking.ViolaJones.detect(t,r,e,n,i,a,o,c);s.fulfill(u)}},["http://localhost:8000/build/tracking.js"]),this.operation},tracking.ObjectTracker.prototype.setClassifiers=function(t){this.classifiers=t},tracking.ObjectTracker.prototype.setEdgesDensity=function(t){this.edgesDensity=t},tracking.ObjectTracker.prototype.setInitialScale=function(t){this.initialScale=t},tracking.ObjectTracker.prototype.setScaleFactor=function(t){this.scaleFactor=t},tracking.ObjectTracker.prototype.setStepSize=function(t){this.stepSize=t}}(),function(){function t(e,n){var i=t.getBaseURL,a=t.getSelfURL,o=t.hasWorkerSupport?t.Operative.BrowserWorker:t.Operative.Iframe;if("function"==typeof e){var s=new o({main:e},n,i,a),c=function(){return s.api.main.apply(s,arguments)};c.transfer=function(){return s.api.main.transfer.apply(s,arguments)};for(var u in s.api)r.call(s.api,u)&&(c[u]=s.api[u]);return c}return new o(e,n,i,a).api}if("undefined"!=typeof window||!self.importScripts){var r={}.hasOwnProperty,e=document.getElementsByTagName("script"),n=e[e.length-1],i=/operative/.test(n.src)&&n.src;t.pool=function(r,e,n){r=0|Math.abs(r)||1;for(var i=[],a=0,o=0;r>o;++o)i.push(t(e,n));return{terminate:function(){for(var t=0;r>t;++t)i[t].destroy()},next:function(){return a=a+1===r?0:a+1,i[a]}}},t.hasWorkerSupport=!!window.Worker,t.hasWorkerViaBlobSupport=!1,t.hasTransferSupport=!1;var a=(location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+location.pathname).replace(/[^\/]+$/,"");t.objCreate=Object.create||function(t){function r(){}return r.prototype=t,new r},t.setSelfURL=function(t){i=t},t.getSelfURL=function(){return i},t.setBaseURL=function(t){a=t},t.getBaseURL=function(){return a},window.operative=t}}(),function(){function t(t){this.value=t}function r(t,r,n,i){var a=this;t.get=t.get||function(t){return this[t]},t.set=t.set||function(t,r){return this[t]=r},this._curToken=0,this._queue=[],this._getBaseURL=n,this._getSelfURL=i,this.isDestroyed=!1,this.isContextReady=!1,this.module=t,this.dependencies=r||[],this.dataProperties={},this.api={},this.callbacks={},this.deferreds={},this._fixDependencyURLs(),this._setup();for(var o in t)e.call(t,o)&&this._createExposedMethod(o);this.api.__operative__=this,this.api.destroy=this.api.terminate=function(){return a.destroy()}}if("undefined"!=typeof window||!self.importScripts){var e={}.hasOwnProperty,n=[].slice,i={}.toString;operative.Operative=r;var a=r.Promise=window.Promise;r.prototype={_marshal:function(t){return t},_demarshal:function(t){return t},_enqueue:function(t){this._queue.push(t)},_fixDependencyURLs:function(){for(var t=this.dependencies,r=0,e=t.length;e>r;++r){var n=t[r];/\/\//.test(n)||(t[r]=n.replace(/^\/?/,this._getBaseURL().replace(/([^\/])$/,"$1/")))}},_dequeueAll:function(){for(var t=0,r=this._queue.length;r>t;++t)this._queue[t].call(this);this._queue=[]},_buildContextScript:function(t){var r,e=[],n=this.module,i=this.dataProperties;for(var a in n)r=n[a],"function"==typeof r?e.push('	self["'+a.replace(/"/g,'\\"')+'"] = '+r.toString()+";"):i[a]=r;return e.join("\n")+(t?"\n("+t.toString()+"());":"")},_createExposedMethod:function(r){var e=this,o=this.api[r]=function(){function i(){e.isContextReady?e._runMethod(r,o,s,u):e._enqueue(i)}if(e.isDestroyed)throw new Error("Operative: Cannot run method. Operative has already been destroyed");var o=++e._curToken,s=n.call(arguments),c="function"==typeof s[s.length-1]&&s.pop(),u=s[s.length-1]instanceof t&&s.pop();if(!c&&!a)throw new Error("Operative: No callback has been passed. Assumed that you want a promise. But `operative.Promise` is null. Please provide Promise polyfill/lib.");if(c)e.callbacks[o]=c,setTimeout(function(){i()},1);else if(a)return new a(function(t,r){var n;t.fulfil||t.fulfill?(n=t,n.fulfil=n.fulfill=t.fulfil||t.fulfill):n={fulfil:t,fulfill:t,resolve:t,reject:r,transferResolve:t,transferReject:r},e.deferreds[o]=n,i()})};o.transfer=function(){var r=[].slice.call(arguments),e="function"==typeof r[r.length-1]?r.length-2:r.length-1,n=r[e],a=i.call(n);if("[object Array]"!==a)throw new Error("Operative:transfer() must be passed an Array of transfers as its last arguments (Expected: [object Array], Received: "+a+")");return r[e]=new t(n),o.apply(null,r)}},destroy:function(){this.isDestroyed=!0}}}}(),function(){function makeBlobURI(t){var r;try{r=new Blob([t],{type:"text/javascript"})}catch(e){r=new BlobBuilder,r.append(t),r=r.getBlob()}return URL.createObjectURL(r)}function workerBoilerScript(){var postMessage=self.postMessage,structuredCloningSupport=null,toString={}.toString;self.console={},self.isWorker=!0,["log","debug","error","info","warn","time","timeEnd"].forEach(function(t){self.console[t]=function(){postMessage({cmd:"console",method:t,args:[].slice.call(arguments)})}}),self.addEventListener("message",function(e){function callback(){returnResult({args:[].slice.call(arguments)})}function returnResult(t,r){postMessage({cmd:"result",token:data.token,result:t},hasTransferSupport&&r||[])}function extractTransfers(t){var r=t[t.length-1];if("[object Array]"!==toString.call(r))throw new Error("Operative: callback.transfer() must be passed an Array of transfers as its last arguments");return r}var data=e.data;if("string"==typeof data&&0===data.indexOf("EVAL|"))return eval(data.substring(5)),void 0;if(null==structuredCloningSupport)return structuredCloningSupport="PING"===e.data[0],self.postMessage(structuredCloningSupport?"pingback:structuredCloningSupport=YES":"pingback:structuredCloningSupport=NO"),structuredCloningSupport||(postMessage=function(t){return self.postMessage(JSON.stringify(t))}),void 0;structuredCloningSupport||(data=JSON.parse(data));var defs=data.definitions,isDeferred=!1,args=data.args;if(defs)for(var i in defs)self[i]=defs[i];else{callback.transfer=function(){var t=[].slice.call(arguments),r=extractTransfers(t);returnResult({args:t},r)},args.push(callback),self.deferred=function(){function t(t,r){return returnResult({isDeferred:!0,action:"resolve",args:[t]},r),e}function r(t,r){returnResult({isDeferred:!0,action:"reject",args:[t]},r)}isDeferred=!0;var e={};return e.fulfil=e.fulfill=e.resolve=function(r){return t(r)},e.reject=function(t){return r(t)},e.transferResolve=function(r){var e=extractTransfers(arguments);return t(r,e)},e.transferReject=function(t){var e=extractTransfers(arguments);return r(t,e)},e};var result=self[data.method].apply(self,args);isDeferred||void 0===result||returnResult({args:[result]}),self.deferred=function(){throw new Error("Operative: deferred() called at odd time")}}})}if("undefined"==typeof window&&self.importScripts)return workerBoilerScript(),void 0;var Operative=operative.Operative,URL=window.URL||window.webkitURL,BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,workerViaBlobSupport=function(){try{new Worker(makeBlobURI(";"))}catch(t){return!1}return!0}(),transferrableObjSupport=function(){try{var t=new ArrayBuffer(1);return new Worker(makeBlobURI(";")).postMessage(t,[t]),!t.byteLength}catch(r){return!1}}();operative.hasWorkerViaBlobSupport=workerViaBlobSupport,operative.hasTransferSupport=transferrableObjSupport,Operative.BrowserWorker=function(){Operative.apply(this,arguments)};var WorkerProto=Operative.BrowserWorker.prototype=operative.objCreate(Operative.prototype);WorkerProto._onWorkerMessage=function(t){var r=t.data;if("string"==typeof r&&0===r.indexOf("pingback"))return"pingback:structuredCloningSupport=NO"===r&&(this._marshal=function(t){return JSON.stringify(t)},this._demarshal=function(t){return JSON.parse(t)}),this.isContextReady=!0,this._postMessage({definitions:this.dataProperties}),this._dequeueAll(),void 0;switch(r=this._demarshal(r),r.cmd){case"console":window.console&&window.console[r.method].apply(window.console,r.args);break;case"result":var e=this.callbacks[r.token],n=this.deferreds[r.token],i=r.result&&r.result.isDeferred&&r.result.action;n&&i?n[i](r.result.args[0]):e?e.apply(this,r.result.args):n&&n.fulfil(r.result.args[0])}},WorkerProto._isWorkerViaBlobSupported=function(){return workerViaBlobSupport},WorkerProto._setup=function(){var t,r=this,e=this._getSelfURL(),n=this._isWorkerViaBlobSupported(),i=this._buildContextScript(n?workerBoilerScript:"");if(this.dependencies.length&&(i='importScripts("'+this.dependencies.join('", "')+'");\n'+i),n)t=this.worker=new Worker(makeBlobURI(i));else{if(!e)throw new Error("Operaritve: No operative.js URL available. Please set via operative.setSelfURL(...)");t=this.worker=new Worker(e),t.postMessage("EVAL|"+i)}t.postMessage("EVAL|self.hasTransferSupport="+transferrableObjSupport),t.postMessage(["PING"]),t.addEventListener("message",function(t){r._onWorkerMessage(t)})},WorkerProto._postMessage=function(t){var r=transferrableObjSupport&&t.transfers;return r?this.worker.postMessage(t,r.value):this.worker.postMessage(this._marshal(t))},WorkerProto._runMethod=function(t,r,e,n){this._postMessage({method:t,args:e,token:r,transfers:n})},WorkerProto.destroy=function(){this.worker.terminate(),Operative.prototype.destroy.call(this)}}(),function(){function t(){window.__run__=function(t,r,e,n){function i(){return e.apply(this,arguments)}var a=!1;window.deferred=function(){return a=!0,n},i.transfer=function(){return e.apply(this,[].slice.call(arguments,0,arguments.length-1))},e&&r.push(i);var o=window[t].apply(window,r);window.deferred=function(){throw new Error("Operative: deferred() called at odd time")},a||void 0===o||i(o)}}if("undefined"!=typeof window||!self.importScripts){var r=operative.Operative;r.Iframe=function(){r.apply(this,arguments)};var e=r.Iframe.prototype=operative.objCreate(r.prototype),n=0;e._setup=function(){var r=this,e="__operativeIFrameLoaded"+ ++n;this.module.isWorker=!1;var i=this.iframe=document.body.appendChild(document.createElement("iframe"));i.style.display="none";var a=this.iframeWindow=i.contentWindow,o=a.document;window[e]=function(){window[e]=null;var n=o.createElement("script"),i=r._buildContextScript(t);void 0!==n.text?n.text=i:n.innerHTML=i,o.documentElement.appendChild(n);for(var s in r.dataProperties)a[s]=r.dataProperties[s];r.isContextReady=!0,r._dequeueAll()},o.open();var s="";this.dependencies.length&&(s+='\n<script src="'+this.dependencies.join('"></script><script src="')+'"></script>'),o.write(s+"\n<script>setTimeout(window.parent."+e+",0);</script>"),o.close()},e._runMethod=function(t,r,e){var n=this,i=this.callbacks[r],a=this.deferreds[r];this.iframeWindow.__run__(t,e,function(t){var r=i,e=a;r?r.apply(n,arguments):e&&e.fulfil(t)},a)},e.destroy=function(){this.iframe.parentNode.removeChild(this.iframe),r.prototype.destroy.call(this)}}}();